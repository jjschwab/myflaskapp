<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Video Processing Portal</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        form { margin-bottom: 20px; }
        label, input, button, select { margin: 10px 0; }
        img { margin-top: 10px; width: 100%; max-width: 300px; }
    </style>
</head>
<body>
    <h1>Video Processing Portal</h1>

    <!-- Form to submit video URL -->
    <form id="videoForm">
        <label for="videoUrl">Enter YouTube video URL:</label>
        <input type="text" id="videoUrl" required placeholder="https://">

        <!-- Dropdown for selecting video category -->
        <label for="categoryChoice">Select Video Category:</label>
        <select id="categoryChoice">
            <option value="1">Mountain Biking</option>
            <option value="2">Skiing</option>
            <option value="3">Surfing</option>
        </select>

        <button type="submit">Process Video</button>
    </form>

    <!-- Section to display all scenes -->
    <div id="results"></div>

    <!-- Section to display the top 10 action scenes -->
    <div id="topActionScenes"></div>

    <script>
        document.getElementById('videoForm').onsubmit = async function(e) {
            e.preventDefault();
            const videoUrl = document.getElementById('videoUrl').value;
            const categoryChoice = document.getElementById('categoryChoice').value; // Get the selected category
            document.getElementById('results').innerHTML = 'Processing... Please wait.';
            document.getElementById('topActionScenes').innerHTML = ''; // Clear previous top scenes

            const response = await fetch('/process_video', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ video_url: videoUrl, category_choice: categoryChoice })
            });

            if (response.ok) {
                const data = await response.json();
                let htmlContent = '<h2>All Scenes:</h2>';
                data.all_scenes.forEach(scene => {
                    htmlContent += `
                        <div>
                            <p>Scene: ${scene.scene_id}</p>
                            <p>Category: ${scene.category}</p>
                            <p>Confidence: ${scene.confidence.toFixed(2)}</p>
                            <p>Start Time: ${scene.start_time}</p>
                            <p>End Time: ${scene.end_time}</p>
                            <p>Duration: ${scene.duration.toFixed(2)} seconds</p>
                            <p>Description: ${scene.best_description}</p>
                            <img src="data:image/jpeg;base64,${scene.image}" alt="Scene Image">
                        </div>`;
                });
                document.getElementById('results').innerHTML = htmlContent;

                // Display top action scenes
                let topScenesContent = '<h2>Top 10 Action Scenes:</h2>';
                data.top_action_scenes.forEach(scene => {
                    topScenesContent += `
                        <div>
                            <p>Scene: ${scene.scene_id}</p>
                            <p>Category: ${scene.category}</p>
                            <p>Confidence: ${scene.confidence.toFixed(2)}</p>
                            <p>Start Time: ${scene.start_time}</p>
                            <p>End Time: ${scene.end_time}</p>
                            <p>Duration: ${scene.duration.toFixed(2)} seconds</p>
                            <p>Description: ${scene.best_description}</p>
                            <img src="data:image/jpeg;base64,${scene.image}" alt="Scene Image">
                        </div>`;
                });
                document.getElementById('topActionScenes').innerHTML = topScenesContent;
            } else {
                document.getElementById('results').innerHTML = 'Failed to process video.';
                document.getElementById('topActionScenes').innerHTML = ''; // Clear if there's an error
            }
        };
    </script>
</body>
</html>
